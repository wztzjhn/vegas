# vegas
A c++ (-std=c++17), **thread-safe**, **header-only** numerical integration routine with importance & stratified samplings [1,2].

## Usage
Simply include the hpp file in your c++ project (take a look at test.cc for example):
```
#include "vegas.hpp"
```

### API
```
// xmin, xmax (integration domain) specified by user, each has dimension ndim
template <typename Integrand>
    Result integrate(Integrand &&integrand, 
        const std::vector<double> &xmin, 
        const std::vector<double> &xmax,
        int ncomp = 1,
        int maxeval = 1000000,
        int niter = 10,
        double alpha = 1.5,
        uint64_t seed = 123456789,
        double rtol = 1e-3,
        double atol = 1e-10,
        int nbins = 50,
        int nstrat = 0,
        int verbose = 0);

// userdata: a Pointer to user data passed to integrand
template <typename Integrand, typename UserData>
    Result integrate_with_data(Integrand &&integrand,
        UserData *userdata,
        const std::vector<double> &xmin, 
        const std::vector<double> &xmax,
        int ncomp = 1,
        int maxeval = 1000000,
        int niter = 10,
        double alpha = 1.5,
        uint64_t seed = 123456789,
        double rtol = 1e-3,
        double atol = 1e-10,
        int nbins = 50,
        int nstrat = 0,
        int verbose = 0);

// xmin, xmax implicitly assumed to be [0, 1] in every dimension
template <typename Integrand>
    Result integrate(Integrand &&integrand,
        int ndim,
        int ncomp = 1,
        int maxeval = 1000000,
        int niter = 10,
        double alpha = 1.5,
        uint64_t seed = 123456789,
        double rtol = 1e-3,
        double atol = 1e-10,
        int nbins = 50,
        int nstrat = 0,
        int verbose = 0);

template <typename Integrand, typename UserData>
    Result integrate_with_data(Integrand &&integrand, 
        UserData *userdata,
        int ndim,
        int ncomp = 1,
        int maxeval = 1000000,
        int niter = 10,
        double alpha = 1.5,
        uint64_t seed = 123456789,
        double rtol = 1e-3,
        double atol = 1e-10,
        int nbins = 50,
        int nstrat = 0,
        int verbose = 0);
```

The integrand has signature
```
void(const std::vector<double> &x, std::vector<double> &f);
```
where `x` is the input point in `[xmin,xmax]^ndim` and `f` is the output vector of size `ncomp`.


## Important Note!!!
While extensive (>20) tests have been passed it is important to note that this code is generated by AI and only marginally modified by human, so use at your own risk. That being said, you can take a look at the outputs by the tests to be assured that the implementation does not have major flaws.

To compile the tests:
```
g++ -std=c++17 -O3 test.cc -o text.x
```


## Refs
[1] G. P. Lepage, A new algorithm for adaptive multidimensional integration, [J. Comp. Phys. 27, 192 (1978)](https://doi.org/10.1016/0021-9991(78)90004-9).

[2] [Official VEGAS website](https://github.com/gplepage/vegas) by G. P. Lepage.
